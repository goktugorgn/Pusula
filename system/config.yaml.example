# =============================================================================
# Pusula Server Configuration
# =============================================================================
# 
# Location: /etc/unbound-ui/config.yaml
# 
# This file configures the Pusula backend server.
# Restart the service after changes: sudo systemctl restart unbound-ui-backend
#
# =============================================================================

# -----------------------------------------------------------------------------
# Server Settings
# -----------------------------------------------------------------------------
server:
  # Bind address (0.0.0.0 for all interfaces, 127.0.0.1 for localhost only)
  host: "0.0.0.0"
  
  # HTTP port for the web interface
  port: 3000
  
  # Enable HTTPS (requires cert/key files)
  # https:
  #   enabled: false
  #   cert: /etc/unbound-ui/ssl/cert.pem
  #   key: /etc/unbound-ui/ssl/key.pem

# -----------------------------------------------------------------------------
# Authentication
# -----------------------------------------------------------------------------
auth:
  # JWT token expiration (in seconds, default: 24 hours)
  tokenExpiry: 86400
  
  # Session cookie settings
  cookie:
    secure: false  # Set to true if using HTTPS
    sameSite: strict

# -----------------------------------------------------------------------------
# Unbound DNS Configuration
# -----------------------------------------------------------------------------
unbound:
  # Path to managed config file (written by Pusula)
  managedConfigPath: /etc/unbound/unbound-ui-managed.conf
  
  # Path to unbound-control socket (if non-default)
  # controlSocket: /var/run/unbound/unbound.sock
  
  # Log file path (for reading logs)
  # logPath: /var/log/unbound/unbound.log

# -----------------------------------------------------------------------------
# Pi-hole Integration (Optional)
# -----------------------------------------------------------------------------
pihole:
  # Enable Pi-hole integration
  enabled: false
  
  # Pi-hole web interface URL
  baseUrl: "http://localhost"
  
  # Pi-hole API token (from Pi-hole Settings -> API)
  # Leave empty for read-only access without token
  apiToken: ""

# -----------------------------------------------------------------------------
# Alerting
# -----------------------------------------------------------------------------
alerts:
  # Enable automatic alerting
  enabled: true
  
  # Check interval in seconds
  checkInterval: 60
  
  # Thresholds
  thresholds:
    # SERVFAIL rate (percentage)
    servfailRate: 5.0
    
    # Cache hit ratio minimum (percentage)
    cacheHitRatio: 50.0
    
    # Unbound down alert
    unboundDown: true

# -----------------------------------------------------------------------------
# Backup Configuration
# -----------------------------------------------------------------------------
backup:
  # Maximum number of snapshots to retain
  maxSnapshots: 10
  
  # Backup directory
  path: /var/lib/unbound-ui/backups

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
logging:
  # Log level: debug, info, warn, error
  level: info
  
  # Audit log path
  auditPath: /var/log/unbound-ui/audit.log
